/*----------------------------------------------------------------------------*/
/* Copyright (c) 2017-2018 FIRST. All Rights Reserved.                        */
/* Open Source Software - may be modified and shared by FRC teams. The code   */
/* must be accompanied by the FIRST BSD license file in the root directory of */
/* the project.                                                               */
/*----------------------------------------------------------------------------*/

package org.usfirst.frc.team3478.robot.subsystems;

import java.util.ArrayList;
import java.util.Arrays;

import org.lambot3478.autonomous_step.AutonomousStep;
import org.lambot3478.autonomous_step.AutonomousStep_Drive;
import org.lambot3478.autonomous_step.AutonomousStep_IntakeElevador;
import org.lambot3478.autonomous_steps.StepFactory_Drive;
import org.lambot3478.autonomous_steps.VectorMoveTime;
import org.usfirst.frc.team3478.robot.RobotMap;

import com.ctre.phoenix.motorcontrol.ControlMode;
import com.ctre.phoenix.motorcontrol.can.TalonSRX;

import edu.wpi.first.wpilibj.Timer;
import edu.wpi.first.wpilibj.command.Subsystem;


public class Robot_Autonomo extends Subsystem {
	public AutonomousStep_Drive[] driveSteps={
			StepFactory_Drive.getNewVectoMove(90,1.0,0.8),
			StepFactory_Drive.getNewVectoMove(-90,1.0,0.8),
			StepFactory_Drive.getNewRotateDegrees(-180)};
	/*public AutonomousStep_IntakeElevador[] intakeSteps={
			StepFactory_Intake.getNewLowerElevator(),
			StepFactory_Intake.getNewWait(1),
			StepFactory_Intake.getNewRaiseElevatorTime(0.7,0.5),
			StepFactory_Intake.getNewPushBoxOut(0.7),
			StepFactory_Intake.getNewLowerElevator(),
			StepFactory_Intake.getNewWait(1),
			StepFactory_Intake.getNewPushBoxOut(0.7)
			};*/
	
	private TalonSRX[] talons;  //arreglo para guadar los talon del chasis
	//Thread intakeThread;
	public Robot_Autonomo(){
		talons=new TalonSRX[]{RobotMap.frontLeft,RobotMap.frontRight,
				RobotMap.backLeft,RobotMap.backRight};
	}
	public void initDefaultCommand() {
		//nada
	}
	private void driveStop(){
		for(TalonSRX talon:talons) {
			talon.set(ControlMode.PercentOutput, 0.0);
		}
	}
	
	////funcion principal del autonomo////////////
	public void RunAuto() {
		Timer safetyTimer=new Timer();
		safetyTimer.start();
		//ArrayList<AutonomousStep> stepsToRun=new ArrayList<>(Arrays.asList(steps));
		/*intakeThread=new Thread(new Runnable(){
			@Override
			public void run(){
				/*for(AutonomousStep_IntakeElevador step:intakeSteps){
					
				}
			}
		});
		intakeThread.start();*/
		for(AutonomousStep_Drive step:driveSteps){
			step.setup();
			step.start();
			while(safetyTimer.get()<15&&!step.isFinished()){
				step.run();
			}
			driveStop();
			if(safetyTimer.get()>=15){
				break;
			}
		}
		safetyTimer.stop();
		driveStop();
	}
	
	/////////////////////////////////////////////
	
	/////////funcion que hace al final del autonomo////////
	public void EndAuto() {
	}
	///////////////////////////////////////////////////
	
}
